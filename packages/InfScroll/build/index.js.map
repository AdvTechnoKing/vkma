{"version":3,"file":"index.js","sources":["../src/components/InfScroll.tsx"],"sourcesContent":["import React from 'react'\n\nconst LoaderSVG = require('./loader.svg') as string\n\ninterface InfScrollProps {\n  children:any,\n  loader?:any,\n  onReachEnd:()=>Promise<unknown>|any,\n  showLoader?:boolean,\n  triggerSize?:string,\n}\n\n/** @description InfScroll - модуль бесконечной прогрузки*.\n * @typedef {Object<any>} Props\n * @property {any} children элемент(ы), находящийся внутри.\n * @property {any} loader элемент загрузки или текст.\n * @property {()=>Promise<unknown>} onReachEnd функция, вызываемая при достижении конца списка.\n * @property {boolean} showLoader выключатель компонента загрузки.\n * @property {string} triggerSize размер зоны срабатывания (50px).\n * @returns {JSX.Element} элемент с содержимой датой и значком прогрузки\n * @example \n * <InfScroll onReachEnd={changeData} showLoader={true}>\n\t\t  {data.map((_,i)=><Card key={i} i={i}/>)}\n\t  </InfScroll>\n */\nexport const InfScroll: React.FC<InfScrollProps> = ({\n  children,\n  loader=<img style={{width: '100%', height: '100px'}} src={LoaderSVG} alt=\"Загрузка ...\" />,\n  onReachEnd,\n  showLoader=true,\n  triggerSize='50px',\n}): JSX.Element => {\n  const rootRef = React.createRef<HTMLDivElement>();\n  const bottomRef = React.createRef<HTMLDivElement>();\n  const [isLoading, setLoading] = React.useState<boolean>(false);\n\n  const scrollCallback = async (entries: IntersectionObserverEntry[]) => {\n    if (entries[0].isIntersecting&&!isLoading) {\n      setLoading(true);\n      await onReachEnd()\n      setTimeout(() => {\n        setLoading(false);\n      }, 500);\n    }\n  };\n\n  React.useEffect(() => {\n    const scroll = new IntersectionObserver(scrollCallback, {\n      root: rootRef.current!,\n      rootMargin: triggerSize\n    });\n    scroll.observe(bottomRef.current!);\n    return () => {\n      scroll.disconnect();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [rootRef, bottomRef]);\n\n  return <div ref={rootRef} style={{height:'100vh',overflowY: 'scroll'}}>\n    {children}\n    <div ref={bottomRef} />\n    {showLoader&&loader}\n  </div>\n}\n\nexport default InfScroll"],"names":["React"],"mappings":";;;;;;;;;;AAEA,MAAM,SAAS,GAAG,OAAO,CAAC,cAAc,CAAW,CAAA;AAUnD;;;;;;;;;;;;;MAaa,SAAS,GAA6B,CAAC,EAClD,QAAQ,EACR,MAAM,GAACA,iDAAK,KAAK,EAAE,EAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAC,EAAE,GAAG,EAAE,SAAS,EAAE,GAAG,EAAC,sDAAc,GAAG,EAC1F,UAAU,EACV,UAAU,GAAC,IAAI,EACf,WAAW,GAAC,MAAM,GACnB;IACC,MAAM,OAAO,GAAGA,yBAAK,CAAC,SAAS,EAAkB,CAAC;IAClD,MAAM,SAAS,GAAGA,yBAAK,CAAC,SAAS,EAAkB,CAAC;IACpD,MAAM,CAAC,SAAS,EAAE,UAAU,CAAC,GAAGA,yBAAK,CAAC,QAAQ,CAAU,KAAK,CAAC,CAAC;IAE/D,MAAM,cAAc,GAAG,OAAO,OAAoC;QAChE,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,cAAc,IAAE,CAAC,SAAS,EAAE;YACzC,UAAU,CAAC,IAAI,CAAC,CAAC;YACjB,MAAM,UAAU,EAAE,CAAA;YAClB,UAAU,CAAC;gBACT,UAAU,CAAC,KAAK,CAAC,CAAC;aACnB,EAAE,GAAG,CAAC,CAAC;SACT;KACF,CAAC;IAEFA,yBAAK,CAAC,SAAS,CAAC;QACd,MAAM,MAAM,GAAG,IAAI,oBAAoB,CAAC,cAAc,EAAE;YACtD,IAAI,EAAE,OAAO,CAAC,OAAQ;YACtB,UAAU,EAAE,WAAW;SACxB,CAAC,CAAC;QACH,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,OAAQ,CAAC,CAAC;QACnC,OAAO;YACL,MAAM,CAAC,UAAU,EAAE,CAAC;SACrB,CAAC;;KAEH,EAAE,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC;IAEzB,OAAOA,iDAAK,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,EAAC,MAAM,EAAC,OAAO,EAAC,SAAS,EAAE,QAAQ,EAAC;QAClE,QAAQ;QACTA,iDAAK,GAAG,EAAE,SAAS,GAAI;QACtB,UAAU,IAAE,MAAM,CACf,CAAA;AACR;;;;"}